<!DOCTYPE html>

<html lang="en-us">

  <head>

    <meta charset="UTF-8">
    <title>CoderBay</title>

    <!-- jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Bootstrap CDN-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <!-- Firebase Reference -->
    <script src="https://www.gstatic.com/firebasejs/3.7.1/firebase.js"></script>

  </head>

  <body>

    <div class="container">

      <br>

      <!-- Jumbotron Title -->
      <div class="jumbotron">
        <h1 class="text-center">Welcome to CodersBay</h1>
        <h3 class="text-center">"Where bidders win big."</h3>
      </div>

      <div class="row">
        <div class="col-lg-12">
          <div class="panel panel-default">
            <div class="panel-body">
              <h3 class="text-center"><strong>Today's Sale</strong>: Pure Vegetarian-Based Coding Knowledge (Chewable)</h3>
            </div>
          </div>
        </div>
      </div>

      <!-- Current Product -->
      <div class="row">
        <div class="col-lg-12">
          <div class="panel panel-default">
            <div class="panel-body">
              <div class="row">
                <div class="col-sm-4 col-sm-offset-2">
                  <img class="img-responsive thumbnail center-block" src="http://graphitepublications.com/wp-content/uploads/2015/04/5-Coding-Challenges-to-Help-You-Train-Your-Brain.jpg" alt="Coding Brain" >
                </div>
                <div class="col-sm-6">
                  <h3 class=""><strong>Highest Bidder:</strong> <span id="highest-bidder"></span></h3>
                  <h3 class=""><strong>Current Price:</strong> <span id="highest-price"></span></h3>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Make Your Bid -->
      <div class="row">
        <div class="col-lg-12">
          <div class="panel panel-default">
            <div class="panel-heading">
              <h3 class="panel-title">Make Your Bid</h3>
            </div>
            <div class="panel-body">
              <form>
                <div class="form-group">
                  <label for="bidder-name">Your Name</label>
                  <input class="form-control" id="bidder-name" type="text">
                </div>
                <div class="form-group">
                  <label for="bidder-price">Your Price</label>
                  <input class="form-control" id="bidder-price" type="number">
                </div>
                <button class="btn btn-primary" id="submit-bid" type="submit">Submit</button>
              </form>
            </div>
          </div>
        </div>

      </div>

    </div>

    <!-- JavaScript -->
    <script src="https://code.jquery.com/jquery.js"></script>

    <script src="https://www.gstatic.com/firebasejs/live/3.0/firebase.js"></script>

    <script>
    // Assign the reference to the database to a variable named 'database'
    //var database = ...

    var config = {
      apiKey: "AIzaSyCyP7V13DHZmR0ALpfBTU7KjIBUfPMU39Y",
      authDomain: "recentu-3a648.firebaseapp.com",
      databaseURL: "https://recentu-3a648.firebaseio.com",
      projectId: "recentu-3a648",
      storageBucket: "",
      messagingSenderId: "720634499762"
    };

    firebase.initializeApp(config);

    var database = firebase.database();

    // Initial Values
    var initialBid = 0;
    var initialBidder = "No one :-(";
    var highPrice = initialBid;
    var highBidder = initialBidder;

    var name = $('#bidder-name').val().trim();
    var price = $('#bidder-price').val().trim();

    // --------------------------------------------------------------

    // At the initial load and subsequent value changes, get a snapshot of the stored data.
    // This function allows you to update your page in real-time when the firebase database changes.
    database.ref().on("value", function(snapshot) {

      // If Firebase has a highPrice and highBidder stored (first case)
      if (snapshot.child("highBidder").exists() && snapshot.child("highPrice").exists()) {

        // Set the variables for highBidder/highPrice equal to the stored values in firebase.
        // highPrice = ...
        // highBidder = ...

         

         
        // Change the HTML to reflect the stored values


        // Print the data to the console.


      }

      // Else Firebase doesn't have a highPrice/highBidder, so use the initial local values.
      else {

        // Change the HTML to reflect the initial values


        // Print the data to the console.


      }


    // If any errors are experienced, log them to console.
    }, function(errorObject) {
      console.log("The read failed: " + errorObject.code);
    });

    // --------------------------------------------------------------

    // Whenever a user clicks the submit-bid button
    $("#submit-bid").on("click", function(event) {
      // Prevent form from submitting
      event.preventDefault();

     

      // Get the input values


      // Log the Bidder and Price (Even if not the highest)
      if (bidderPrice > highPrice) {

        // Alert
        alert("You are now the highest bidder.");

        // Save the new price in Firebase
        database.ref().set({
        nameKey : name,
        priceKey : price
        });


        // Log the new High Price



        // Store the new high price and bidder name as a local variable


        // Change the HTML to reflect the new high price and bidder

      }

      else {
        // Alert
        alert("Sorry that bid is too low. Try again.");
      }

    });


    </script>

  </body>

</html>